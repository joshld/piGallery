<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Frame Control</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="stylesheet" href="/static/themes.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üñºÔ∏è piGallery Web Control</h1>
            <p>Control the piGallery from anywhere on the network</p>
        </header>

        <div class="alert" id="alert"></div>

        <div class="tab-container">
            <button class="tab-button active" onclick="switchTab('status')">üìä Status</button>
            <button class="tab-button" onclick="switchTab('system')">üíª System</button>
        </div>

        <div id="tab-status" class="tab-content active">
        <div class="status-bar">
            <h2 style="margin-bottom: 15px;" class="text-accent">üìä Current Device Status</h2>
            <div class="status-grid">
                <div class="status-item">
                    <div class="status-label">‚è∞ Time</div>
                    <div class="status-value" id="status-time">--:--</div>
                </div>
                <div class="status-item">
                    <div class="status-label">üìÖ Date</div>
                    <div class="status-value" id="status-date">---</div>
                </div>
                <div class="status-item">
                    <div class="status-label">üå°Ô∏è Temperature</div>
                    <div class="status-value" id="status-temp">--¬∞C</div>
                </div>
                <div class="status-item">
                    <div class="status-label">‚òÅÔ∏è Weather</div>
                    <div class="status-value" id="status-weather">---</div>
                </div>
                <div class="status-item">
                    <div class="status-label">üì∏ Image</div>
                    <div class="status-value" id="status-index">- / -</div>
                </div>
                <div class="status-item">
                    <div class="status-label">‚ñ∂Ô∏è State</div>
                    <div class="status-value" id="status-paused">Playing</div>
                </div>
                <div class="status-item">
                    <div class="status-label">‚è±Ô∏è Next Image In</div>
                    <div class="status-value" id="status-countdown">--s</div>
                </div>
            </div>
            <div class="image-preview-container">
                <h3 style="margin-bottom: 15px; font-size: 1.1em;" class="text-accent">üì∏ Current Image</h3>
                <div class="current-image-info text-secondary" id="current-image" style="margin-bottom: 15px; font-size: 0.95em;">No image loaded</div>
                <div style="display: flex; justify-content: center; align-items: center; width: 100%;">
                    <img id="image-preview" src="" alt="Current image preview" 
                         style="max-width: 100%; max-height: 400px; border-radius: 10px; 
                                box-shadow: 0 4px 15px rgba(0,0,0,0.2); display: none;"
                         onclick="showFullImage()" title="Click to view full-size image">
                </div>
                <div class="playback-controls-below-preview">
                    <button class="btn-primary" onclick="previousImage()">‚¨ÖÔ∏è Previous</button>
                    <button class="btn-warning" onclick="togglePause()" id="pauseBtn">‚è∏Ô∏è Pause</button>
                    <button class="btn-primary" onclick="nextImage()">Next ‚û°Ô∏è</button>
                </div>
            </div>

            <div class="caption-editor-container bg-secondary" style="margin-top: 30px; padding: 20px; border-radius: 10px; border: 1px solid var(--border-divider);">
                <h3 style="margin-bottom: 15px; font-size: 1.1em;" class="text-accent">‚úèÔ∏è Image Caption</h3>
                <div style="margin-bottom: 10px;">
                    <textarea id="caption-text" placeholder="Enter caption for this image (saved to image metadata)..." 
                              style="width: 100%; min-height: 100px; padding: 12px; border: 2px solid var(--input-border); border-radius: 8px; font-size: 0.95em; font-family: inherit; resize: vertical; box-sizing: border-box; color: var(--input-text); background: var(--bg-input);"></textarea>
                </div>
                <div class="caption-controls">
                    <button class="btn-success" onclick="saveCaption()" id="save-caption-btn">üíæ Save Caption</button>
                    <button class="btn-secondary" onclick="loadCaption()" id="load-caption-btn">üîÑ Reload</button>
                    <span id="caption-status" class="caption-status"></span>
                </div>
            </div>

            <div id="imageModal" class="image-modal" onclick="closeFullImage(event)">
                <span class="image-modal-close">&times;</span>
                <div class="image-modal-content">
                    <img id="full-image" src="" alt="Full-size image">
                </div>
            </div>
        </div>

        <div class="controls">

            <div class="control-card">
                <h2>üí° Display Control</h2>
                <div class="button-group">
                    <button class="btn-success" onclick="setDisplay('on')">Turn On</button>
                    <button class="btn-secondary" onclick="setDisplay('off')">Turn Off</button>
                </div>
                <button class="btn-primary btn-full" onclick="setDisplay('auto')">üîÑ Auto Mode</button>
                
                <div style="margin-top: 25px; padding-top: 25px; border-top: 1px solid var(--border-divider);"></div>
                <h2>‚ö° System Power</h2>
                <small class="text-small" style="display: block; margin-top: 10px; border-radius: 8px; padding: 10px;">
                    ‚ö†Ô∏è Requires sudo privileges. System will countdown before executing.
                </small>
                <div class="button-group" id="power-buttons-container">
                    <button class="btn-danger" onclick="confirmShutdown()">üî¥ Shutdown</button>
                    <button class="btn-info" onclick="confirmRestart()">üîÑ Restart</button>
                </div>
                <div id="power-action-status" style="display: none; margin-top: 10px; padding: 10px; background: var(--alert-warning-bg); border: 1px solid var(--alert-warning-border); border-radius: 8px; color: var(--alert-warning-text);">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span id="power-action-message">‚è≥ Power action in progress...</span>
                        <button class="btn-secondary" style="padding: 6px 15px; font-size: 0.9em;" onclick="cancelPowerAction()">‚ùå Cancel</button>
                    </div>
                </div>
            </div>

            <div class="control-card">
                <h2>üì§ Upload Photos</h2>
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                    <p style="font-size: 1.2em; margin-bottom: 10px;">üìÅ Click or Drop Files Here</p>
                    <p class="text-secondary">JPG, JPEG, PNG supported</p>
                    <input type="file" id="fileInput" accept="image/jpeg,image/jpg,image/png" multiple onchange="handleFileSelect(this.files)">
                </div>
                
                <div id="uploadPreview" style="display: none; margin-top: 20px;">
                    <h3 style="font-size: 1.1em; margin-bottom: 15px;" class="text-accent">üìã Files Ready to Upload</h3>
                    <div id="fileList" class="bg-secondary" style="margin-bottom: 15px; max-height: 200px; overflow-y: auto; border: 1px solid var(--input-border); border-radius: 8px; padding: 8px; width: 100%; box-sizing: border-box;"></div>
                    
                    <div style="margin-top: 15px;">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">‚úèÔ∏è Caption (optional - applies to all uploaded files)</label>
                        <textarea id="upload-caption" placeholder="Enter a caption to add to all uploaded photos..." 
                                  style="width: 100%; min-height: 60px; padding: 10px; border: 2px solid var(--input-border); border-radius: 8px; font-size: 0.95em; font-family: inherit; resize: vertical; box-sizing: border-box; color: var(--input-text); background: var(--bg-input);"></textarea>
                    </div>
                    
                    <div style="margin-top: 15px; display: flex; gap: 8px; justify-content: center;">
                        <button class="btn-success" onclick="uploadSelectedFiles()" id="uploadBtn" style="padding: 8px 16px; font-size: 0.9em;">üì§ Upload All</button>
                        <button class="btn-secondary" onclick="clearFileSelection()" style="padding: 8px 16px; font-size: 0.9em;">üóëÔ∏è Clear</button>
                    </div>
                </div>
                
                <div id="uploadStatus" style="margin-top: 15px;"></div>

                <!-- Manage Uploaded Images Button -->
                <div style="margin-top: 20px; text-align: center;">
                    <button id="manage-images-btn" class="btn-secondary" onclick="openManageImagesModal()"
                            style="padding: 10px 20px; font-size: 0.95em; display: inline-flex; align-items: center; gap: 8px;">
                        üìÅ Manage Uploaded Images
                        <span id="uploaded-count" style="background: var(--accent-primary); color: white; padding: 2px 6px; border-radius: 10px; font-size: 0.8em; min-width: 20px;">0</span>
                    </button>
                </div>

                <div style="margin-top: 25px; padding-top: 25px; border-top: 1px solid var(--border-divider);">
                    <h3 style="font-size: 1.3em; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--accent-primary);" class="text-accent">üìÅ Directories</h3>
                    <div class="settings-group">
                        <div class="setting-item">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <label class="text-label" style="flex: 1;">Images Directory</label>
                                <button onclick="browseDirectory('images-directory')" class="browse-button" 
                                        title="Browse for directory">
                                    üìÅ
                                </button>
                            </div>
                            <input type="text" id="images-directory" placeholder="/path/to/images" 
                                   onchange="updateSetting('images_directory', this.value)"
                                   title="Click to edit or use browse button"
                                   style="width: 100%; padding: 8px 12px; border: 2px solid var(--input-border); border-radius: 8px; font-size: 1em; color: var(--input-text); background: var(--bg-input); box-sizing: border-box; text-align: left;">
                        </div>
                        <div class="setting-item">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <label class="text-label" style="flex: 1;">Upload Directory</label>
                                <button onclick="browseDirectory('upload-directory')" class="browse-button"
                                        title="Browse for directory">
                                    üìÅ
                                </button>
                            </div>
                            <input type="text" id="upload-directory" placeholder="Leave empty for default" 
                                   onchange="updateSetting('upload_directory', this.value)"
                                   title="Click to edit or use browse button"
                                   style="width: 100%; padding: 8px 12px; border: 2px solid var(--input-border); border-radius: 8px; font-size: 1em; color: var(--input-text); background: var(--bg-input); box-sizing: border-box; text-align: left;">
                            <small class="text-small" style="display: block; margin-top: 8px;">
                                default: [ImagesDirectory]/uploaded/
                            </small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-card">
                <h2>üëÅÔ∏è Display Options</h2>
                <div class="settings-group">
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Show Time</span>
                            <div class="toggle-switch" id="toggle-time" onclick="toggleSetting('show_time', this)"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Show Date</span>
                            <div class="toggle-switch" id="toggle-date" onclick="toggleSetting('show_date', this)"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Show Temperature</span>
                            <div class="toggle-switch" id="toggle-temp" onclick="toggleSetting('show_temperature', this)"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Show Weather</span>
                            <div class="toggle-switch" id="toggle-weather" onclick="toggleSetting('show_weather_code', this)"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Show Filename</span>
                            <div class="toggle-switch" id="toggle-filename" onclick="toggleSetting('show_filename', this)"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Show Caption</span>
                            <div class="toggle-switch" id="toggle-caption" onclick="toggleSetting('show_caption', this)"></div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Shutdown on Display Off</span>
                            <div class="toggle-switch" id="toggle-shutdown" onclick="toggleSetting('shutdown_on_display_off', this)"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-card wide">
                <h2>‚öôÔ∏è Advanced Settings</h2>
                <div class="settings-group">
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Location (City)</label>
                        <input type="text" id="location-city" list="location-list" placeholder="City, State, Country" 
                               onchange="updateSetting('location_city_suburb', this.value)"
                               style="width: 100%;">
                        <datalist id="location-list">
                            <!-- City only examples -->
                            <option value="Sydney">
                            <option value="Melbourne">
                            <option value="London">
                            <option value="Paris">
                            <option value="Tokyo">
                            <!-- City, Country examples -->
                            <option value="Sydney, Australia">
                            <option value="Melbourne, Australia">
                            <option value="Brisbane, Australia">
                            <option value="Perth, Australia">
                            <option value="Adelaide, Australia">
                            <option value="Canberra, Australia">
                            <option value="London, UK">
                            <option value="Manchester, UK">
                            <option value="Birmingham, UK">
                            <option value="Edinburgh, UK">
                            <option value="Toronto, Canada">
                            <option value="Vancouver, Canada">
                            <option value="Montreal, Canada">
                            <option value="Calgary, Canada">
                            <option value="Paris, France">
                            <option value="Berlin, Germany">
                            <option value="Madrid, Spain">
                            <option value="Rome, Italy">
                            <option value="Amsterdam, Netherlands">
                            <option value="Tokyo, Japan">
                            <option value="Seoul, South Korea">
                            <option value="Beijing, China">
                            <option value="Shanghai, China">
                            <option value="Bangkok, Thailand">
                            <option value="Mumbai, India">
                            <option value="Delhi, India">
                            <option value="Dubai, UAE">
                            <option value="Cairo, Egypt">
                            <option value="Johannesburg, South Africa">
                            <option value="S√£o Paulo, Brazil">
                            <option value="Rio de Janeiro, Brazil">
                            <option value="Buenos Aires, Argentina">
                            <option value="Mexico City, Mexico">
                            <!-- City, State, Country examples -->
                            <option value="New York, NY, USA">
                            <option value="Los Angeles, CA, USA">
                            <option value="Chicago, IL, USA">
                            <option value="Houston, TX, USA">
                            <option value="Phoenix, AZ, USA">
                            <option value="Philadelphia, PA, USA">
                            <option value="San Antonio, TX, USA">
                            <option value="San Diego, CA, USA">
                            <option value="Dallas, TX, USA">
                            <option value="San Jose, CA, USA">
                            <!-- Special cases -->
                            <option value="Hong Kong">
                            <option value="Singapore">
                        </datalist>
                        <small class="text-small" style="display: block; margin-top: 8px;">
                            Formats: "City", "City, Country", or "City, State, Country" (e.g. "Sydney", "Sydney, Australia", "New York, NY, USA")
                        </small>
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Delay (seconds)</label>
                        <input type="number" id="delay-seconds" min="1" max="3600" value="30" 
                               onchange="updateSetting('delay_seconds', this.value)">
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Display Off Time</label>
                        <input type="time" id="display-off-time" onchange="updateSetting('display_off_time', this.value)">
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Display On Time</label>
                        <input type="time" id="display-on-time" 
                               onchange="updateSetting('display_on_time', this.value)">
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Shutdown Countdown (seconds)</label>
                        <input type="number" id="shutdown-countdown" min="0" max="60" value="10" 
                               onchange="updateSetting('shutdown_countdown_seconds', this.value)">
                        <small class="text-small" style="display: block; margin-top: 8px;">
                            Countdown time before shutdown when "Shutdown on Display Off" is enabled
                        </small>
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Weather Update (seconds)</label>
                        <input type="number" id="weather-update" min="60" max="3600" value="900" 
                               onchange="updateSetting('weather_update_seconds', this.value)">
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">UI Text Alpha (0-255)</label>
                        <input type="number" id="ui-text-alpha" min="0" max="255" value="192" 
                               onchange="updateSetting('ui_text_alpha', this.value)">
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Display Correction (Horizontal)</label>
                        <input type="number" id="display-correction-horizontal" step="0.01" min="0.5" max="2.0" value="1.0" 
                               onchange="updateSetting('display_correction_horizontal', this.value)">
                        <small class="text-small">Compensate for horizontal hardware stretching (default: 1.0)</small>
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Display Correction (Vertical)</label>
                        <input type="number" id="display-correction-vertical" step="0.01" min="0.5" max="2.0" value="1.0" 
                               onchange="updateSetting('display_correction_vertical', this.value)">
                        <small class="text-small">Compensate for vertical hardware stretching (default: 1.0)</small>
                    </div>
                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Color Theme</label>
                        <select id="theme-selector" onchange="changeTheme(this.value)" 
                                style="padding: 8px 12px; border: 2px solid var(--input-border); border-radius: 8px; font-size: 1em; font-family: inherit; width: 100%; box-sizing: border-box; color: var(--input-text); background: var(--bg-input);">
                            <option value="default">Default</option>
                            <option value="light">Light</option>
                            <option value="dark">Dark</option>
                            <option value="nord">Nord</option>
                            <option value="dracula">Dracula</option>
                            <option value="solarized-dark">Solarized Dark</option>
                            <option value="solarized-light">Solarized Light</option>
                            <option value="gruvbox">Gruvbox</option>
                            <option value="one-dark">One Dark</option>
                            <option value="material-dark">Material Dark</option>
                            <option value="material-light">Material Light</option>
                            <option value="high-contrast">High Contrast</option>
                            <option value="forest">Forest</option>
                            <option value="ocean">Ocean</option>
                            <option value="monochrome">Monochrome</option>
                            <option value="monokai">Monokai</option>
                            <option value="flatland">Flatland</option>
                            <option value="catppuccin-mocha">Catppuccin Mocha</option>
                            <option value="catppuccin-macchiato">Catppuccin Macchiato</option>
                            <option value="catppuccin-frappe">Catppuccin Frapp√©</option>
                            <option value="catppuccin-latte">Catppuccin Latte</option>
                            <option value="tokyo-night">Tokyo Night</option>
                        </select>
                        <small class="text-small">Choose your preferred color scheme</small>
                    </div>

                    <div class="setting-item">
                        <label class="text-label" style="display: block; margin-bottom: 8px;">Image Sort Order</label>
                        <select id="sort-order" onchange="updateSetting('sort_order', this.value)"
                                style="padding: 8px 12px; border: 2px solid var(--input-border); border-radius: 8px; font-size: 1em; font-family: inherit; width: 100%; box-sizing: border-box; color: var(--input-text); background: var(--bg-input);">
                            <option value="random">Random (Default)</option>
                            <option value="filename">Filename (A-Z)</option>
                            <option value="date_taken">Date Taken (EXIF)</option>
                            <option value="date_created">Date Created (File)</option>
                            <option value="date_modified">Date Modified (File)</option>
                            <option value="size">File Size (Largest First)</option>
                        </select>
                        <small class="text-small">How to order images in the slideshow</small>
                    </div>

                    <div class="setting-item">
                        <div class="setting-item-row">
                            <span>Reverse Order</span>
                            <div class="toggle-switch" id="toggle-sort-reverse" onclick="toggleSetting('sort_reverse', this)"></div>
                        </div>
                        <small class="text-small">Reverse the selected sort order</small>
                        <small class="text-small">Choose your preferred color scheme</small>
                        <div id="theme-debug" style="margin-top: 8px; padding: 8px; background: var(--bg-secondary); border-radius: 4px; font-size: 0.85em; color: var(--text-secondary);">
                            <strong>Debug:</strong> Current theme: <span id="current-theme-display">loading...</span>
                </div>
                    </div>
                </div>
            </div>

            <div id="directoryModal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2>Select Directory</h2>
                        <span class="close" onclick="closeDirectoryBrowser()">&times;</span>
                    </div>
                    <div id="directoryBrowser">
                        <p>Loading directories...</p>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <div id="tab-system" class="tab-content">
            <div class="status-bar">
                <h2 style="margin-bottom: 15px;" class="text-accent">üíª System Resources</h2>
                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">üíæ Free Memory</div>
                        <div class="status-value" id="status-memory">-- MB</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">‚ö° CPU Usage</div>
                        <div class="status-value" id="status-cpu">--%</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">üå°Ô∏è CPU Temperature</div>
                        <div class="status-value" id="status-cpu-temp">--¬∞C</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">üíø Free Disk Space</div>
                        <div class="status-value" id="status-disk-free">-- GB</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">üìä Disk Used</div>
                        <div class="status-value" id="status-disk-used">--%</div>
                    </div>
                </div>
            </div>

            <div class="status-bar">
                <div class="log-header">
                    <h2 style="margin: 0;" class="text-accent">üìã Logs</h2>
                    <div class="log-controls">
                        <select id="log-lines" onchange="loadLogs()" style="padding: 5px 10px; border: 2px solid var(--input-border); border-radius: 5px; color: var(--input-text); background: var(--bg-input);">
                            <option value="50">Last 50 lines</option>
                            <option value="100" selected>Last 100 lines</option>
                            <option value="200">Last 200 lines</option>
                            <option value="500">Last 500 lines</option>
                        </select>
                        <button onclick="loadLogs()" class="btn-primary" style="padding: 5px 15px;">üîÑ Refresh</button>
                    </div>
                </div>
                <div id="log-viewer" class="log-viewer">
                    Loading logs...
                </div>
            </div>

        </div>
    </div>

    <!-- Shutdown Confirmation Modal -->
    <div id="shutdownModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>‚ö†Ô∏è Confirm Shutdown</h2>
                <span class="close" onclick="closeShutdownModal()">&times;</span>
            </div>
            <div style="padding: 20px;">
                <p style="margin-bottom: 20px;">Are you sure you want to shutdown the system?</p>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 500; margin-bottom: 8px;">Countdown (seconds):</label>
                    <input type="number" id="shutdown-countdown-input" min="0" max="60" value="10" 
                           style="width: 100%; padding: 8px; border: 2px solid var(--input-border); border-radius: 8px; color: var(--input-text); background: var(--bg-input);">
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-danger" style="flex: 1;" onclick="executeShutdown()">Shutdown</button>
                    <button class="btn-secondary" style="flex: 1;" onclick="closeShutdownModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Restart Confirmation Modal -->
    <div id="restartModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîÑ Confirm Restart</h2>
                <span class="close" onclick="closeRestartModal()">&times;</span>
            </div>
            <div style="padding: 20px;">
                <p style="margin-bottom: 20px;">Are you sure you want to restart the system?</p>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; font-weight: 500; margin-bottom: 8px;">Countdown (seconds):</label>
                    <input type="number" id="restart-countdown-input" min="0" max="60" value="10" 
                           style="width: 100%; padding: 8px; border: 2px solid var(--input-border); border-radius: 8px; color: var(--input-text); background: var(--bg-input);">
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-info" style="flex: 1;" onclick="executeRestart()">Restart</button>
                    <button class="btn-secondary" style="flex: 1;" onclick="closeRestartModal()">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Manage Uploaded Images Modal -->
    <div id="manageImagesModal" class="modal">
        <div class="modal-content" style="max-width: 900px; max-height: 80vh;">
            <div class="modal-header">
                <h2>üìÅ Manage Uploaded Images</h2>
                <span class="close" onclick="closeManageImagesModal()">&times;</span>
            </div>

            <div style="padding: 20px;">
                <!-- Loading state -->
                <div id="images-loading" style="text-align: center; padding: 40px;">
                    <div style="font-size: 1.2em; margin-bottom: 10px;">üîÑ Loading images...</div>
                    <div class="loading-spinner"></div>
                </div>

                <!-- Empty state -->
                <div id="images-empty" style="display: none; text-align: center; padding: 40px; color: var(--text-secondary);">
                    <div style="font-size: 3em; margin-bottom: 15px;">üì≠</div>
                    <div style="font-size: 1.2em; margin-bottom: 10px;">No uploaded images found</div>
                    <div style="font-size: 0.9em;">Upload some images first to see them here</div>
                </div>

                <!-- Images grid -->
                <div id="images-grid" style="display: none;">
                    <div style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                        <div id="images-count" style="font-weight: 500;"></div>
                        <div style="display: flex; gap: 8px;">
                            <button id="select-all-btn" class="btn-secondary" onclick="toggleSelectAll()"
                                    style="padding: 6px 12px; font-size: 0.85em;">Select All</button>
                            <button id="edit-mode-btn" class="btn-secondary" onclick="toggleEditMode()"
                                    style="padding: 6px 12px; font-size: 0.85em;"></button>
                        </div>
                    </div>

                    <div id="images-container" class="images-grid"
                         style="display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 15px; max-height: 400px; overflow-y: auto; padding: 10px; border: 1px solid var(--border-divider); border-radius: 8px; background: var(--bg-card);">
                        <!-- Images will be populated here by JavaScript -->
                    </div>

                    <!-- Edit Mode Status -->
                    <div id="edit-mode-notice" style="display: none; margin-top: 15px; padding: 10px; background: var(--bg-secondary); border-radius: 8px; border-left: 4px solid var(--accent-primary);">
                        <strong>‚úèÔ∏è Edit Mode Active:</strong> Click filenames or captions to edit them. Click "Save Changes" when done.
                    </div>
                </div>

                <!-- Action buttons -->
                <div id="images-actions" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border-divider);">
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <button id="delete-selected-btn" class="btn-danger" onclick="deleteSelectedImages()" disabled
                                style="padding: 10px 20px; font-size: 0.95em;">
                            üóëÔ∏è Delete Selected (<span id="selected-count">0</span>)
                        </button>
                        <button class="btn-secondary" onclick="closeManageImagesModal()"
                                style="padding: 10px 20px; font-size: 0.95em;">
                            Close
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sticky Save Button -->
    <button class="sticky-save-button" onclick="saveSettingsSticky()" id="sticky-save-btn">
        üíæ Save Settings
    </button>

    <script src="/static/app.js"></script>
</body>
</html>

